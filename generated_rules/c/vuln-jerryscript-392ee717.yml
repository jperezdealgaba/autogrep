rules:
- id: vuln-jerryscript-392ee717
  pattern: 'ecma_value_t $RET = ECMA_VALUE_EMPTY;

    ECMA_TRY_CATCH($VAR, $FUNC($ARGS), $RET);

    ...

    return $RET;

    '
  pattern-not: "ecma_value_t $VAR = $FUNC($ARGS);\nif (ECMA_IS_VALUE_ERROR($VAR))\
    \ {\n  return $VAR;\n}\n...\nreturn $RESULT;\n"
  languages:
  - c
  message: "The code uses ECMA_TRY_CATCH macros for error handling, which can lead\
    \ to resource leaks and improper error propagation. \nThe patched version directly\
    \ checks for errors using ECMA_IS_VALUE_ERROR and returns immediately, ensuring\
    \ proper resource cleanup and error handling.\nTo fix this, replace ECMA_TRY_CATCH\
    \ usage with direct error checking and explicit resource cleanup.\n"
  severity: ERROR
  metadata:
    source-url: github.com/galpeter/jerryscript/commit/392ee717128f6daaf0b94e54fc9512eb26d680e2
    category: security
    cwe:
    - CWE-703
    owasp: A10:2021 - Server-Side Request Forgery
    references:
    - https://github.com/jerryscript-project/jerryscript/issues/1234
    technology:
    - c
