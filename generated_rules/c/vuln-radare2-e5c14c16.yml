rules:
- id: vuln-radare2-e5c14c16
  pattern: "for ($I = $J = 0; $I < sizeof($BUF) - 1 && $STR[$I]; $I++, $J++) {\n \
    \ ...\n}\n"
  pattern-not: "for ($I = $J = 0; $I < sizeof($BUF) - 1 && $STR[$J]; $I++, $J++) {\n\
    \  ...\n}\n"
  languages:
  - c
  message: 'Detected a potential off-by-one error in a loop condition where the string
    index is incorrectly compared against the buffer size. This could lead to buffer
    overflows or incorrect string processing. The issue arises from using the wrong
    index variable in the loop condition. To fix this, ensure that the correct index
    variable is used for string access.

    '
  severity: ERROR
  metadata:
    source-url: github.com/radare/radare2/commit/e5c14c167b0dcf0a53d76bd50bacbbcc0dfc1ae7
    category: security
    cwe:
    - CWE-193
    owasp: 'A1: Injection'
    technology:
    - c
