rules:
- id: vuln-chakracore-d73c5f12
  pattern: '$CTX->ClearDisableImplicitFlags();

    JavascriptFunction::CallRootFunctionInScript($FUNC, $ARGS);

    $CTX->SetImplicitCallFlags($FLAGS);

    '
  pattern-not: "{\n  AutoRestoreFlags $VAR($CTX, $FLAGS, $DISABLEFLAGS);\n  JavascriptFunction::CallRootFunctionInScript($FUNC,\
    \ $ARGS);\n}\n"
  message: 'Detected unsafe manual manipulation of thread context flags around function
    calls.

    This pattern is vulnerable because it doesn''t properly restore thread context
    flags

    in case of exceptions. Use the AutoRestoreFlags RAII pattern instead to ensure

    proper cleanup in all execution paths.

    '
  languages:
  - cpp
  severity: WARNING
  metadata:
    source-url: github.com/chakra-core/ChakraCore/commit/d73c5f12d9c5cbbf64f59ae04e76a531b3e844b3
    category: security
    cwe:
    - CWE-665
    owasp: A9:2017-Using Components with Known Vulnerabilities
    technology:
    - cpp
