rules:
- id: vuln-chakracore-d73c5f12
  pattern: '$CTX->GetImplicitCallFlags();

    $CTX->ClearDisableImplicitFlags();

    JavascriptFunction::CallRootFunctionInScript(...);

    $CTX->SetImplicitCallFlags(...);

    '
  pattern-not: "{\n  AutoRestoreFlags $VAR(...);\n  JavascriptFunction::CallRootFunctionInScript(...);\n\
    }\n"
  languages:
  - cpp
  message: Improper thread context flag management without RAII guard can lead to
    inconsistent state and security vulnerabilities
  severity: ERROR
  metadata:
    source-url: github.com/Microsoft/ChakraCore/commit/d73c5f12d9c5cbbf64f59ae04e76a531b3e844b3
    category: security
    technology:
    - cpp
